---
title: "Task 4 - Analyzing Purple Urchins in Naples Reef"
author: "Trevor Maggart"
date: "10/28/2021"
output: html_document
---
## Overview

This code analyzes data pertaining to purple sea urchins collected by divers with the Santa Barbara Coastal Long Term Ecological Research program. The analysis below focuses on purple urchins at the Naple Reef site in the year 2010. 

### Data Citation

Citation: Santa Barbara Coastal LTER and D. Reed. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b (Accessed 2021-10-26).

## Setup

```{r setup, message=F}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

### Install Packages

To wrangle the data we will use the packages `tidyverse`, `here`, `janitor`, `kableExtra`, and `lubridate`.

```{r packages}
# Attach packages
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(kableExtra)
```

## Read in the data

### Read in the urchins data & conver to 'lower_case_snake'

```{r}
# Read in the data
urchins <- read_csv(here("data","urchins.csv")) %>%
  clean_names() # Clean the data to lower_case_snake
```

### Create a subset of the data

#### Include Naples Reef observations for purple urchins observed in 2010

```{r}
purple_urchins_NAPL_2010 <- urchins %>%
  filter(common_name == "Purple Urchin") %>% # Filter for purple urchin
  filter(site == "NAPL") %>% # Filter for Naples Reef
  mutate(Date = mdy(date)) %>% # Create a new date column
  mutate(year = year(Date)) %>% # Create a new year column
  filter(year == "2010") # Filter for 2010
```

## Explore histograms & QQ-plots for purple urchin size distribution

### Comparing the Control and Annual treatments with a histogram

```{r}
ggplot(data = purple_urchins_NAPL_2010,
       aes(x = size)) +
  geom_histogram(aes(fill = treatment)) +
   facet_wrap(~ treatment) +
  theme_gray() +
  theme(legend.position = "none")
```

### Comparing the Control and Annual treatments with a QQplot

```{r}
ggplot(data = purple_urchins_NAPL_2010) +
  geom_qq(aes(sample = size, color = treatment)) +
  theme_gray() +
  facet_wrap(~ treatment) +
  theme(legend.position = "none")
```

## Making a table to summarize the data

### Summarize the data

```{r}
purple_urchins_NAPL_2010_summary <- purple_urchins_NAPL_2010 %>%
  group_by(treatment) %>% # Group by 'treatment'
  summarize(mean_size = round(mean(size, na.rm = TRUE)), # Create mean column
            median_size = median(size, na.rm = TRUE), # Create median column
            sd_size = round(sd(size, na.rm = TRUE)), # Create standard deviation column
            sample_size = n()) # Get the count
```

### Create a summary table with `kableExtra`

```{r}
purple_urchins_NAPL_2010_summary %>% 
  kable(col.names = c("Treatment",
                      "Mean Size (cm)",
                      "Median Size (cm)",
                      "Standard Deviation (cm)",
                      "Sample Size"),
        caption = "<center>Table 1. Summary of Statistics of Purple Urchins in the Naple Reef<center>") %>%
  kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
```